#Data inspection
genotypes <- read.delim("fang_et_al_genotypes.txt")
snp_pos <-read.delim("snp_position.txt")
setwd("~/Desktop/DV_R-Assignment")
#Data inspection
genotypes <- read.delim("fang_et_al_genotypes.txt")
snp_pos <-read.delim("snp_position.txt")
#PART2-DATA GRAPHING
#load the following
if (!require("ggplot2")) install.packages("ggplot2")
if (!require("ggplot2")) install.packages("ggplot2")
library(ggplot2)
if(!require("tibble")) install.packages("tibble")
library(tibble)
if (!require("reshape2")) install.packages("reshape2")
library(reshape2)
if(!require("dplyr")) install.packages("dplyr")
library(dplyr)
if (!require("plyr")) install.packages("plyr")
library(plyr)
transposed_genotypes <- as.data.frame(t(genotypes))
names(transposed_genotypes) <- lapply(transposed_genotypes[1,], as.character) #this makes column one a character
transposed_genotypes <- transposed_genotypes[-1,]
new_transposed_genotypes <- rownames_to_column(transposed_genotypes, var="SNP_ID")
sorted_genotypes <- arrange(new_transposed_genotypes, SNP_ID)
joined_genotypes <- merge(sorted_snp_pos_chrom,sorted_genotypes, by.x="SNP_ID", by.y="SNP_ID", all = TRUE)
ggplot(data = joined_genotypes) +
geom_bar(mapping = aes(x = Chromosome)) +
scale_x_discrete(limits=c(1:10, "unknown", "multiple")) +
ggtitle(label = "SNPs per chromosome") +
xlab(label = "Chromosome #") +
ylab(label = "# of SNPs") +
theme(
plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12)
)
snp_pos_chrom <- snp_pos[, c("SNP_ID", "Chromosome", "Position")]
sorted_snp_pos_chrom <- arrange(snp_pos_chrom, SNP_ID)
sorted_genotypes <- arrange(new_transposed_genotypes, SNP_ID)
joined_genotypes <- merge(sorted_snp_pos_chrom,sorted_genotypes, by.x="SNP_ID", by.y="SNP_ID", all = TRUE)
ggplot(data = joined_genotypes) +
geom_bar(mapping = aes(x = Chromosome)) +
scale_x_discrete(limits=c(1:10, "unknown", "multiple")) +
ggtitle(label = "SNPs per chromosome") +
xlab(label = "Chromosome #") +
ylab(label = "# of SNPs") +
theme(
plot.title = element_text(hjust = 0.5, size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12)
)
SNP_header <- colnames(genotypes)[-c(1:3)] #making a header for all SNP_IDs.
m.genotype  <- melt(genotypes, measure.vars = SNP_header) #using melt function make our SNP_ID as rows
colnames(m.genotype)[4] <- "SNP_ID" #renaming the 4th column from "variable" to SNP_ID
m.genotype[ m.genotype == "?/?" ] = "N/A"
m.genotype_new <-
mutate(m.genotype, Homozygous = m.genotype$value=="A/A" | m.genotype$value=="C/C" | m.genotype$value=="G/G" | m.genotype$value=="T/T")
m.genotype_new$Homozygous [ m.genotype_new$Homozygous == "TRUE"] = "Homozygous"
m.genotype_new$Homozygous [ m.genotype_new$Homozygous == "FALSE"] = "Heterozygous"
m.genotype_new$Homozygous [ m.genotype_new$value == "N/A"] = "Missing"
ggplot(data = m.genotype_new) +
geom_bar(mapping = aes(x=Sample_ID, fill=Homozygous)) +
scale_x_discrete(labels=NULL)+
ggtitle(label = "Heterozygosity By Sample ID") +
xlab(label = "Sample ID") +
ylab(label = "Amount")
ggplot(data = m.genotype_new) +
geom_bar(mapping = aes(x=Group, fill=Homozygous), position="dodge")
ggplot(data = m.genotype_new) +
geom_bar(mapping = aes(x=Group, fill=Homozygous), position="dodge")+ theme(axis.text.x = element_text(angle = 90))
m.joined_geno <- merge(sorted_snp_pos_chrom, m.genotype_new, by.x="SNP_ID", by.y="SNP_ID", all = TRUE)
ggplot(data= m.joined_geno) +
geom_bar(mapping = aes(x = Chromosome, fill=Homozygous),position="dodge")+
scale_x_discrete(limits=c(1:10, "unknown", "multiple")) +
ggtitle(label = "Heterozygosity per Chromosome") +
xlab(label = "Chromosome #") +
ylab(label = "Amount of Heterozygosity")
ggplot(data= m.joined_geno) +
geom_point(mapping = aes(x = Position, y=SNP_ID))
ggplot(data= m.joined_geno) +
geom_bar(mapping = aes(x = Chromosome, fill=Homozygous),position="dodge")+
scale_x_discrete(limits=c(1:10, "unknown", "multiple")) +
ggtitle(label = "Heterozygosity per Chromosome") +
xlab(label = "Chromosome #") +
ylab(label = "Amount of Heterozygosity")
ggplot(data = m.genotype_new) +
geom_bar(mapping = aes(x=Group, fill=Homozygous), position="dodge") +
ggtitle(label = "Heterozygosity by Group") +
theme(axis.text.x = element_text(angle = 90))
knitr::opts_chunk$set(echo = TRUE)
transposed_maize <- as.data.frame(t(maize_genotypes))
